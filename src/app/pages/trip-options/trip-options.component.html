<ion-header>
  <ion-toolbar mode="ios">
    <ion-buttons slot="start">
      <ion-button color="medium" (click)="cancel()">
        <ion-icon slot="icon-only" name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title color="primary">Nuevo Viaje</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="page-content ion-padding">
  <!-- Origen y Destino -->
  <div class="field-group">
    <div class="header-title">
              <span>Ubicaciones</span>
            </div>
    <ion-item lines="none" class="field-item">
      <ion-icon name="navigate" slot="start"></ion-icon>
      <ion-input
        label="Origen"
        label-placement="floating"
        fill="outline"
        placeholder="Origen"
        [(ngModel)]="origin">
      </ion-input>
      <ion-button fill="clear" size="small" slot="end" *ngIf="origin" (click)="origin=''">
        <ion-icon name="close-circle" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-item>

    <ion-item lines="none" class="field-item">
      <ion-icon name="location" slot="start"></ion-icon>
      <ion-input
        label="Destino"
        label-placement="floating"
        fill="outline"
        placeholder="Destino"
        [(ngModel)]="destination"
        #modalInput>
      </ion-input>
      <ion-button fill="clear" size="small" slot="end" *ngIf="destination" (click)="destination=''">
        <ion-icon name="close-circle" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-item>
  </div>

  <!-- Paradas dinámicas -->
  <div class="add-stop-row">
    <div class="add-stop-left">
      <ion-toggle [(ngModel)]="showStopToggle"></ion-toggle>
       <span class="label">Añadir parada</span>
    </div>
    <ion-button *ngIf="showStopToggle" fill="solid" shape="round" (click)="addStop()" class="btn-add-stop">
      <ion-icon name="add"></ion-icon>
    </ion-button>
  </div>

  <ng-container *ngIf="showStopToggle">
    <ion-item *ngFor="let stop of stops; let i=index" lines="full" class="field-item stop-item">
      <ion-icon name="ellipse-outline" slot="start"></ion-icon>
      <ion-input
        label="Parada {{ i + 1 }}"
        label-placement="floating"
        fill="outline"
        placeholder="Dirección de parada"
        [(ngModel)]="stops[i]">
      </ion-input>
      <ion-button fill="clear" size="small" slot="end" (click)="removeStop(i)">
        <ion-icon name="close-circle"></ion-icon>
      </ion-button>
    </ion-item>
  </ng-container>

  <!-- Botón Mapa -->
<ion-item class="map-container" lines="none" button>
  <div class="icon-wrapper">
    <ion-icon name="map-outline"></ion-icon>
  </div>
  <ion-label class="map-label">Localizar en el mapa</ion-label>
</ion-item>

   <!-- Selector de Lugares -->
          <div class="vehicle-chip-list">
             <div class="header-title">
              <span>Lugares</span>
            </div>
            <ion-chip *ngFor="let v of vehicleTypes" [outline]="v.value !== selectedVehicle"
              [color]="v.value === selectedVehicle ? 'primary' : undefined" (click)="selectVehicle(v.value)">
              <ion-icon [name]="v.icon" slot="start"></ion-icon>
              <ion-label>{{ v.label }}</ion-label>
            </ion-chip>
          </div>

<!-- Lista Ubicaciones -->
<ion-list class="location-list">
  <ion-item lines="none" class="location-item" button>
    <div class="icon-circle">
      <ion-icon slot="start" name="play-forward-outline"></ion-icon>
    </div>
    <ion-label>Casa</ion-label>
  </ion-item>
  <ion-item lines="none" class="location-item" button>
    <div class="icon-circle">
      <ion-icon slot="start" name="play-forward-outline"></ion-icon>
    </div>
    <ion-label>Casa</ion-label>
  </ion-item>
  <ion-item lines="none" class="location-item" button>
    <div class="icon-circle">
      <ion-icon slot="start" name="play-forward-outline"></ion-icon>
    </div>
    <ion-label>Trabajo</ion-label>
  </ion-item>
</ion-list>

  <!-- Confirmar Viaje -->
  <ion-button expand="block" class="btn-confirm" (click)="confirm()">
    ¡Vamos!
    <ion-icon name="rocket-outline"></ion-icon>
  </ion-button>

  <app-detail-trip-modal #detailTripModal></app-detail-trip-modal>
    >
</ion-content>
